C51 COMPILER V9.54   MAIN                                                                  05/10/2021 17:25:15 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\OBJ\main.obj
COMPILER INVOKED BY: C:\Program Files (x86)\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND P
                    -RINT(.\LIST\main.lst) TABS(2) OBJECT(.\OBJ\main.obj)

line level    source

   1          #include <reg52.h>
   2          #include <stdio.h>
   3          #include <math.h>
   4          #include "1602.h"
   5          #include "delay.h"
   6          #include "string.h"
   7          #include "MatrixKey.h"
   8          sbit TRIGL = P2 ^ 0;
   9          sbit ECHOL = P2 ^ 1;
  10          sbit TRIGB = P2 ^ 2;
  11          sbit ECHOB = P2 ^ 3;
  12          sbit TRIGR = P3 ^ 6;
  13          sbit ECHOR = P3 ^ 7;
  14          sbit SPK = P2 ^ 7;
  15          unsigned char DisTempData[7];
  16          unsigned char code studentid[]="0123456789";
  17          float S, arr[9], temp;
  18          int leftnumber=0, backnumber=0, rightnumber=0;
  19          int i, k=0, j, KeyNum = 10;
  20          /*------------------------------------------------
  21                     主函数
  22          ------------------------------------------------*/
  23          void TIM1init(void)
  24          {
  25   1      
  26   1        TMOD |= 0x10;
  27   1        TH1 = 0x00;
  28   1        TL1 = 0x00;
  29   1        ET1 = 1;
  30   1        EA = 1;
  31   1      }
  32          /*------------------------------------------------
  33                  主函数
  34          ------------------------------------------------*/
  35          main()
  36          {
  37   1        TIM1init();
  38   1        LCD_Init();
  39   1        while (1)
  40   1        {
  41   2      
  42   2          /*蜂鸣器警戒值输入*/
  43   2          while (k <= 3)
  44   2          {
  45   3            if (k == 0)
  46   3            {
  47   4                LCD_Write_String(0, 1, " L___ B___ R___ ");
  48   4            }
  49   3            LCD_Write_String(0, 0, "   input dist   ");
  50   3            KeyNum = MatrixKey();
  51   3            if (KeyNum == 13)
  52   3            {
  53   4              k++;
  54   4              if (k == 1)
C51 COMPILER V9.54   MAIN                                                                  05/10/2021 17:25:15 PAGE 2   

  55   4              {
  56   5                for (i = 2; i < 5;)
  57   5                {
  58   6                  KeyNum = MatrixKey();
  59   6                  if(i==2)
  60   6                  {
  61   7                  if(KeyNum>0&&KeyNum<10)
  62   7                  {
  63   8                  leftnumber+=(KeyNum*100);
  64   8                  }
  65   7                  }
  66   6                  if(i==3)
  67   6                  {
  68   7                  if(KeyNum>0&&KeyNum<10)
  69   7                  {
  70   8                  leftnumber+=(KeyNum*10);
  71   8                  }
  72   7                  }
  73   6                  if(i==4)
  74   6                  {
  75   7                  if(KeyNum>0&&KeyNum<10)
  76   7                  {
  77   8                  leftnumber+=(KeyNum);
  78   8                  }
  79   7                  }
  80   6                  if (KeyNum < 10)
  81   6                  {
  82   7                    
  83   7                    LCD_Write_Char(i, 1, studentid[KeyNum]);
  84   7                    i++;
  85   7                  }
  86   6                  DelayMs(50);
  87   6              
  88   6                }
  89   5              }
  90   4              if (k == 2)
  91   4              {
  92   5                for (i = 7; i < 10; )
  93   5                {
  94   6                  KeyNum = MatrixKey();
  95   6                  if(i==7)
  96   6                  {
  97   7                  if(KeyNum>0&&KeyNum<10)
  98   7                  {
  99   8                  backnumber+=(KeyNum*100);
 100   8                  }
 101   7                  }
 102   6                  if(i==8)
 103   6                  {
 104   7                  if(KeyNum>0&&KeyNum<10)
 105   7                  {
 106   8                  backnumber+=(KeyNum*10);
 107   8                  }
 108   7                  }
 109   6                  if(i==9)
 110   6                  {
 111   7                  if(KeyNum>0&&KeyNum<10)
 112   7                  {
 113   8                  backnumber+=(KeyNum);
 114   8                  }
 115   7                  }
 116   6                  if (KeyNum < 10)
C51 COMPILER V9.54   MAIN                                                                  05/10/2021 17:25:15 PAGE 3   

 117   6                  {
 118   7                    LCD_Write_Char(i, 1, studentid[KeyNum]);
 119   7                    i++;
 120   7                  }
 121   6                  DelayMs(50);
 122   6                }
 123   5              }
 124   4              if (k == 3)
 125   4              {
 126   5                k=4;
 127   5                for (i = 12; i < 15; )
 128   5                {
 129   6                  KeyNum = MatrixKey();
 130   6                  if(i==12)
 131   6                  {
 132   7                  if(KeyNum>0&&KeyNum<10)
 133   7                  {
 134   8                  rightnumber+=(KeyNum*100);
 135   8                  }
 136   7                  }
 137   6                  if(i==13)
 138   6                  {
 139   7                  if(KeyNum>0&&KeyNum<10)
 140   7                  {
 141   8                  rightnumber+=(KeyNum*10);
 142   8                  }
 143   7                  }
 144   6                  if(i==14)
 145   6                  {
 146   7                  if(KeyNum>0&&KeyNum<10)
 147   7                  {
 148   8                  rightnumber+=(KeyNum);
 149   8                  }
 150   7                  }
 151   6                  if (KeyNum < 10)
 152   6                  {
 153   7                    LCD_Write_Char(i, 1, studentid[KeyNum]);
 154   7                    i++;
 155   7                  }
 156   6                  DelayMs(50);
 157   6                }
 158   5      
 159   5                LCD_Write_String(0, 0, "                ");
 160   5              }
 161   4            }
 162   3          }
 163   2        
 164   2          
 165   2          /*------------------------------------------------
 166   2                  右方
 167   2          ------------------------------------------------*/
 168   2          if (1)
 169   2          {
 170   3            /*one*/
 171   3            TRIGR = 1;
 172   3            DelayUs2x(10);
 173   3            TRIGR = 0;
 174   3            while (!ECHOR);
 175   3            TR1 = 1;
 176   3            while (ECHOR);
 177   3            TR1 = 0;
 178   3            S = TH1 * 256 + TL1;
C51 COMPILER V9.54   MAIN                                                                  05/10/2021 17:25:15 PAGE 4   

 179   3            S = S / 58;
 180   3            arr[0] = S;
 181   3            TH1 = 0;
 182   3            TL1 = 0;
 183   3            /*two*/
 184   3            TRIGR = 1;
 185   3            DelayUs2x(10);
 186   3            TRIGR = 0;
 187   3            while (!ECHOR);
 188   3            TR1 = 1;
 189   3            while (ECHOR);
 190   3            TR1 = 0;
 191   3            S = TH1 * 256 + TL1;
 192   3            S = S / 58;
 193   3            arr[1] = S;
 194   3            TH1 = 0;
 195   3            TL1 = 0;
 196   3            /*third*/
 197   3            TRIGR = 1;
 198   3            DelayUs2x(10);
 199   3            TRIGR = 0;
 200   3            while (!ECHOR);
 201   3            TR1 = 1;
 202   3            while (ECHOR);
 203   3            TR1 = 0;
 204   3            S = TH1 * 256 + TL1;
 205   3            S = S / 58;
 206   3            arr[2] = S;
 207   3            TH1 = 0;
 208   3            TL1 = 0;
 209   3            /*four*/
 210   3            TRIGR = 1;
 211   3            DelayUs2x(10);
 212   3            TRIGR = 0;
 213   3            while (!ECHOR);
 214   3            TR1 = 1;
 215   3            while (ECHOR);
 216   3            TR1 = 0;
 217   3            S = TH1 * 256 + TL1;
 218   3            S = S / 58;
 219   3            arr[3] = S;
 220   3            TH1 = 0;
 221   3            TL1 = 0;
 222   3            /*five*/
 223   3            TRIGR = 1;
 224   3            DelayUs2x(10);
 225   3            TRIGR = 0;
 226   3            while (!ECHOR);
 227   3            TR1 = 1;
 228   3            while (ECHOR);
 229   3            TR1 = 0;
 230   3            S = TH1 * 256 + TL1;
 231   3            S = S / 58;
 232   3            arr[4] = S;
 233   3            TH1 = 0;
 234   3            TL1 = 0;
 235   3            /*SIX*/
 236   3            TRIGR = 1;
 237   3            DelayUs2x(10);
 238   3            TRIGR = 0;
 239   3            while (!ECHOR);
 240   3            TR1 = 1;
C51 COMPILER V9.54   MAIN                                                                  05/10/2021 17:25:15 PAGE 5   

 241   3            while (ECHOR);
 242   3            TR1 = 0;
 243   3            S = TH1 * 256 + TL1;
 244   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 245   3            arr[5] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 246   3            TH1 = 0;
 247   3            TL1 = 0;
 248   3            /*SEVEN*/
 249   3            TRIGR = 1;
 250   3            DelayUs2x(10);
 251   3            TRIGR = 0;
 252   3            while (!ECHOR);
 253   3            TR1 = 1;
 254   3            while (ECHOR);
 255   3            TR1 = 0;
 256   3            S = TH1 * 256 + TL1;
 257   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 258   3            arr[6] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 259   3            TH1 = 0;
 260   3            TL1 = 0;
 261   3            /*EIGHT*/
 262   3            TRIGR = 1;
 263   3            DelayUs2x(10);
 264   3            TRIGR = 0;
 265   3            while (!ECHOR);
 266   3            TR1 = 1;
 267   3            while (ECHOR);
 268   3            TR1 = 0;
 269   3            S = TH1 * 256 + TL1;
 270   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 271   3            arr[7] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 272   3            TH1 = 0;
 273   3            TL1 = 0;
 274   3            /*NINE*/
 275   3            TRIGR = 1;
 276   3            DelayUs2x(10);
 277   3            TRIGR = 0;
 278   3            while (!ECHOR);
 279   3            TR1 = 1;
 280   3            while (ECHOR);
 281   3            TR1 = 0;
 282   3            S = TH1 * 256 + TL1;
 283   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 284   3            arr[8] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 285   3            TH1 = 0;
 286   3            TL1 = 0;
 287   3            /*TEN*/
 288   3            TRIGR = 1;
 289   3            DelayUs2x(10);
 290   3            TRIGR = 0;
 291   3            while (!ECHOR);
 292   3            TR1 = 1;
 293   3            while (ECHOR);
 294   3            TR1 = 0;
 295   3            S = TH1 * 256 + TL1;
 296   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 297   3            arr[9] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 298   3            TH1 = 0;
 299   3            TL1 = 0;
 300   3            /*try*/
 301   3      
 302   3            for (i = 0; i < 10 - 1; i++)
C51 COMPILER V9.54   MAIN                                                                  05/10/2021 17:25:15 PAGE 6   

 303   3              for (j = 0; j < 10 - 1 - i; j++)
 304   3                if (arr[j] > arr[j + 1])
 305   3                {
 306   4                  temp = arr[j];
 307   4                  arr[j] = arr[j + 1];
 308   4                  arr[j + 1] = temp;
 309   4                }
 310   3            /*try*/
 311   3            S = ((arr[1] + arr[2] + arr[3] + arr[4] + arr[5] + arr[6] + arr[7] + arr[8]) / 8);
 312   3            temp=rightnumber;
 313   3            if (S < temp)
 314   3            {
 315   4              for (i = 0; i < 200; i++)
 316   4              {
 317   5             DelayUs2x(200);
 318   5             SPK = !SPK;
 319   5              }
 320   4              SPK = 0;//防止一直给喇叭通电造成损坏
 321   4      
 322   4            }
 323   3            sprintf(DisTempData, "R=%6.2f",S);
 324   3            LCD_Write_String(0, 1, DisTempData);
 325   3          }
 326   2          /*------------------------------------------------
 327   2                左方
 328   2          ------------------------------------------------*/
 329   2          if (1)
 330   2          {
 331   3            /*one*/
 332   3            TRIGL = 1;
 333   3            DelayUs2x(10);
 334   3            TRIGL = 0;
 335   3            while (!ECHOL);
 336   3            TR1 = 1;
 337   3            while (ECHOL);
 338   3            TR1 = 0;
 339   3            S = TH1 * 256 + TL1;
 340   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 341   3            arr[0] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 342   3            TH1 = 0;
 343   3            TL1 = 0;
 344   3            /*two*/
 345   3            TRIGL = 1;
 346   3            DelayUs2x(10);
 347   3            TRIGL = 0;
 348   3            while (!ECHOL);
 349   3            TR1 = 1;
 350   3            while (ECHOL);
 351   3            TR1 = 0;
 352   3            S = TH1 * 256 + TL1;
 353   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 354   3            arr[1] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 355   3            TH1 = 0;
 356   3            TL1 = 0;
 357   3            /*third*/
 358   3            TRIGL = 1;
 359   3            DelayUs2x(10);
 360   3            TRIGL = 0;
 361   3            while (!ECHOL);
 362   3            TR1 = 1;
 363   3            while (ECHOL);
 364   3            TR1 = 0;
C51 COMPILER V9.54   MAIN                                                                  05/10/2021 17:25:15 PAGE 7   

 365   3            S = TH1 * 256 + TL1;
 366   3            S = S / 58;
 367   3            arr[2] = S;
 368   3            TH1 = 0;
 369   3            TL1 = 0;
 370   3            /*four*/
 371   3            TRIGL = 1;
 372   3            DelayUs2x(10);
 373   3            TRIGL = 0;
 374   3            while (!ECHOL);
 375   3            TR1 = 1;
 376   3            while (ECHOL);
 377   3            TR1 = 0;
 378   3            S = TH1 * 256 + TL1;
 379   3            S = S / 58;
 380   3            arr[3] = S;
 381   3            TH1 = 0;
 382   3            TL1 = 0;
 383   3            /*five*/
 384   3            TRIGL = 1;
 385   3            DelayUs2x(10);
 386   3            TRIGL = 0;
 387   3            while (!ECHOL);
 388   3            TR1 = 1;
 389   3            while (ECHOL);
 390   3            TR1 = 0;
 391   3            S = TH1 * 256 + TL1;
 392   3            S = S / 58;
 393   3            arr[4] = S;
 394   3            TH1 = 0;
 395   3            TL1 = 0;
 396   3            /*SIX*/
 397   3            TRIGL = 1;
 398   3            DelayUs2x(10);
 399   3            TRIGL = 0;
 400   3            while (!ECHOL);
 401   3            TR1 = 1;
 402   3            while (ECHOL);
 403   3            TR1 = 0;
 404   3            S = TH1 * 256 + TL1;
 405   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 406   3            arr[5] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 407   3            TH1 = 0;
 408   3            TL1 = 0;
 409   3            /*SEVEN*/
 410   3            TRIGL = 1;
 411   3            DelayUs2x(10);
 412   3            TRIGL = 0;
 413   3            while (!ECHOL);
 414   3            TR1 = 1;
 415   3            while (ECHOL);
 416   3            TR1 = 0;
 417   3            S = TH1 * 256 + TL1;
 418   3            S = S / 58;
 419   3            arr[6] = S;
 420   3            TH1 = 0;
 421   3            TL1 = 0;
 422   3            /*EIGHT*/
 423   3            TRIGL = 1;
 424   3            DelayUs2x(10);
 425   3            TRIGL = 0;
 426   3            while (!ECHOL);
C51 COMPILER V9.54   MAIN                                                                  05/10/2021 17:25:15 PAGE 8   

 427   3            TR1 = 1;
 428   3            while (ECHOL);
 429   3            TR1 = 0;
 430   3            S = TH1 * 256 + TL1;
 431   3            S = S / 58;
 432   3            arr[7] = S;
 433   3            TH1 = 0;
 434   3            TL1 = 0;
 435   3            /*NINE*/
 436   3            TRIGL = 1;
 437   3            DelayUs2x(10);
 438   3            TRIGL = 0;
 439   3            while (!ECHOL);
 440   3            TR1 = 1;
 441   3            while (ECHOL);
 442   3            TR1 = 0;
 443   3            S = TH1 * 256 + TL1;
 444   3            S = S / 58;
 445   3            arr[8] = S;
 446   3            TH1 = 0;
 447   3            TL1 = 0;
 448   3            /*TEN*/
 449   3            TRIGL = 1;
 450   3            DelayUs2x(10);
 451   3            TRIGL = 0;
 452   3            while (!ECHOL);
 453   3            TR1 = 1;
 454   3            while (ECHOL);
 455   3            TR1 = 0;
 456   3            S = TH1 * 256 + TL1;
 457   3            S = S / 58;
 458   3            arr[9] = S;
 459   3            TH1 = 0;
 460   3            TL1 = 0;
 461   3            /*try*/
 462   3            for (i = 0; i < 10 - 1; i++)
 463   3              for (j = 0; j < 10 - 1 - i; j++)
 464   3                if (arr[j] > arr[j + 1])
 465   3                {
 466   4                  temp = arr[j];
 467   4                  arr[j] = arr[j + 1];
 468   4                  arr[j + 1] = temp;
 469   4                }
 470   3            /*try*/
 471   3            S = ((arr[1] + arr[2] + arr[3] + arr[4] + arr[5] + arr[6] + arr[7] + arr[8]) / 8);
 472   3            temp=leftnumber;
 473   3            if (S < temp)
 474   3            {
 475   4              for (i = 0; i < 200; i++)
 476   4              {
 477   5                DelayUs2x(200);
 478   5                SPK = !SPK;
 479   5              }
 480   4              SPK = 0;//防止一直给喇叭通电造成损坏
 481   4              
 482   4            }
 483   3            
 484   3            sprintf(DisTempData,"L=%6.2f", S);
 485   3            LCD_Write_String(8, 1, DisTempData);
 486   3          }
 487   2          /*------------------------------------------------
 488   2                  后方
C51 COMPILER V9.54   MAIN                                                                  05/10/2021 17:25:15 PAGE 9   

 489   2          ------------------------------------------------*/
 490   2          if (1)
 491   2          {
 492   3            TRIGB = 1;
 493   3            DelayUs2x(10);
 494   3            TRIGB = 0;
 495   3            while (!ECHOB);
 496   3            TR1 = 1;
 497   3            while (ECHOB);
 498   3            TR1 = 0;
 499   3            S = TH1 * 256 + TL1;
 500   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 501   3            arr[0] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 502   3            TH1 = 0;
 503   3            TL1 = 0;
 504   3            /*two*/
 505   3            TRIGB = 1;
 506   3            DelayUs2x(10);
 507   3            TRIGB = 0;
 508   3            while (!ECHOB);
 509   3            TR1 = 1;
 510   3            while (ECHOB);
 511   3            TR1 = 0;
 512   3            S = TH1 * 256 + TL1;
 513   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 514   3            arr[1] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 515   3            TH1 = 0;
 516   3            TL1 = 0;
 517   3            /*third*/
 518   3            TRIGB = 1;
 519   3            DelayUs2x(10);
 520   3            TRIGB = 0;
 521   3            while (!ECHOB);
 522   3            TR1 = 1;
 523   3            while (ECHOB);
 524   3            TR1 = 0;
 525   3            S = TH1 * 256 + TL1;
 526   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 527   3            arr[2] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 528   3            TH1 = 0;
 529   3            TL1 = 0;
 530   3            /*four*/
 531   3            TRIGB = 1;
 532   3            DelayUs2x(10);
 533   3            TRIGB = 0;
 534   3            while (!ECHOB);
 535   3            TR1 = 1;
 536   3            while (ECHOB);
 537   3            TR1 = 0;
 538   3            S = TH1 * 256 + TL1;
 539   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 540   3            arr[3] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 541   3            TH1 = 0;
 542   3            TL1 = 0;
 543   3            /*five*/
 544   3            TRIGB = 1;
 545   3            DelayUs2x(10);
 546   3            TRIGB = 0;
 547   3            while (!ECHOB);
 548   3            TR1 = 1;
 549   3            while (ECHOB);
 550   3            TR1 = 0;
C51 COMPILER V9.54   MAIN                                                                  05/10/2021 17:25:15 PAGE 10  

 551   3            S = TH1 * 256 + TL1;
 552   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 553   3            arr[4] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 554   3            TH1 = 0;
 555   3            TL1 = 0;
 556   3            /*SIX*/
 557   3            TRIGB = 1;
 558   3            DelayUs2x(10);
 559   3            TRIGB = 0;
 560   3            while (!ECHOB);
 561   3            TR1 = 1;
 562   3            while (ECHOB);
 563   3            TR1 = 0;
 564   3            S = TH1 * 256 + TL1;
 565   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 566   3            arr[5] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 567   3            TH1 = 0;
 568   3            TL1 = 0;
 569   3            /*SEVEN*/
 570   3            TRIGB = 1;
 571   3            DelayUs2x(10);
 572   3            TRIGB = 0;
 573   3            while (!ECHOB);
 574   3            TR1 = 1;
 575   3            while (ECHOB);
 576   3            TR1 = 0;
 577   3            S = TH1 * 256 + TL1;
 578   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 579   3            arr[6] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 580   3            TH1 = 0;
 581   3            TL1 = 0;
 582   3            /*EIGHT*/
 583   3            TRIGB = 1;
 584   3            DelayUs2x(10);
 585   3            TRIGB = 0;
 586   3            while (!ECHOB);
 587   3            TR1 = 1;
 588   3            while (ECHOB);
 589   3            TR1 = 0;
 590   3            S = TH1 * 256 + TL1;
 591   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 592   3            arr[7] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 593   3            TH1 = 0;
 594   3            TL1 = 0;
 595   3            /*NINE*/
 596   3            TRIGB = 1;
 597   3            DelayUs2x(10);
 598   3            TRIGB = 0;
 599   3            while (!ECHOB);
 600   3            TR1 = 1;
 601   3            while (ECHOB);
 602   3            TR1 = 0;
 603   3            S = TH1 * 256 + TL1;
 604   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 605   3            arr[8] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 606   3            TH1 = 0;
 607   3            TL1 = 0;
 608   3            /*TEN*/
 609   3            TRIGB = 1;
 610   3            DelayUs2x(10);
 611   3            TRIGB = 0;
 612   3            while (!ECHOB);
C51 COMPILER V9.54   MAIN                                                                  05/10/2021 17:25:15 PAGE 11  

 613   3            TR1 = 1;
 614   3            while (ECHOB);
 615   3            TR1 = 0;
 616   3            S = TH1 * 256 + TL1;
 617   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 618   3            arr[9] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 619   3            TH1 = 0;
 620   3            TL1 = 0;
 621   3            /*try*/
 622   3            for (i = 0; i < 10 - 1; i++)
 623   3              for (j = 0; j < 10 - 1 - i; j++)
 624   3                if (arr[j] > arr[j + 1])
 625   3                {
 626   4                  temp = arr[j];
 627   4                  arr[j] = arr[j + 1];
 628   4                  arr[j + 1] = temp;
 629   4                }
 630   3            /*try*/
 631   3            S = ((arr[1] + arr[2] + arr[3] + arr[4] + arr[5] + arr[6] + arr[7] + arr[8]) / 8);
 632   3            temp=backnumber;
 633   3            if (S < temp)
 634   3            {
 635   4              for (i = 0; i < 200; i++)
 636   4              {
 637   5                DelayUs2x(200);
 638   5                SPK = !SPK;
 639   5              }
 640   4              SPK = 0;//防止一直给喇叭通电造成损坏
 641   4      
 642   4            }
 643   3          
 644   3            sprintf(DisTempData, "B=%6.2f", S);
 645   3            LCD_Write_String(4, 0, DisTempData);
 646   3      
 647   3          }
 648   2        }
 649   1      }
 650          
 651          /*------------------------------------------------
 652                   中断
 653          ------------------------------------------------*/
 654          void Timer0_isr(void) interrupt 2
 655          {
 656   1        ECHOL = 0;
 657   1        ECHOB = 0;
 658   1        ECHOR = 0;
 659   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   4215    ----
   CONSTANT SIZE    =     86    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     65    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
