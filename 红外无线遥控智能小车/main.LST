C51 COMPILER V9.54   MAIN                                                                  05/12/2021 11:38:35 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: C:\Program Files (x86)\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND T
                    -ABS(2)

line level    source

   1          /*********************************************************************************
   2          * ¡¾±àÐ´Ê±¼ä¡¿£º 2020Äê12ÔÂ12ÈÕ
   3          * ¡¾×÷    Õß¡¿£º ÇåÏèµç×Ó:03
   4          * ¡¾°æ    ±¾¡¿£º 1.0
   5          * ¡¾Íø    Õ¾¡¿£º http://www.QXMBOT.com/ 
   6          * ¡¾ÌÔ±¦µêÆÌ¡¿£º http://qxmcu.taobao.com/ (Ö±Ïúµê)
   7          * ¡¾ÊµÑéÆ½Ì¨¡¿£º QX-A11ÑÇ¿ËÁ¦ÖÇÄÜÐ¡³µ  STC89C52
   8          * ¡¾Íâ²¿¾§Õñ¡¿£º 11.0592mhz 
   9          * ¡¾Ö÷¿ØÐ¾Æ¬¡¿£º STC89C52
  10          * ¡¾±àÒë»·¾³¡¿£º Keil ¦ÌVisio4
  11          * °æÈ¨ËùÓÐ£¬µÁ°æ±Ø¾¿¡£
  12          * Copyright(C) QXMBOT
  13          * All rights reserved
  14          ***********************************************************************************
  15          * ¡¾½ÓÏßËµÃ÷¡¿£ºÇë²Î¿¼×ÊÁÏÄÚÍ¼ÎÄËµÃ÷Êé
  16          ³ÌÐòÃâ·Ñ¿ªÔ´£¬²»Ìá¹©´úÂë·ÖÎö
  17          ×¢ÒâÊÂÏîÐèÒªÓÃ»§²ÎÔÄ¡°*Ì×²Í×é×°µ÷ÊÔÖ¸ÄÏ¡± 
  18          ³ÌÐòÖ»×ö²Î¿¼£¬¸ù¾ÝÊµ¼ÊÔËÐÐÐ§¹û¿ÉÄÜ»¹ÐèÒªÓÃ»§×ÔÐÐµ÷ÊÔ                                
  19          **********************************************************************************/
  20          
  21          /*¿ª·¢°åP32¶Ë¿Ú²»ÄÜ½Ó¶Å°îÏß£¬·ñÔòÎÞ·¨Ò£¿Ø*/
  22          
  23          #include <reg52.h> //51Í·ÎÄ¼þ
  24          #include <QX_A11.h>//QX-A51ÖÇÄÜÐ¡³µÅäÖÃÎÄ¼þ
  25          #include <stdio.h>
  26          #include <math.h>
  27          #include "1602.h"
  28          #include "delay.h"
  29          //#include "MatrixKey.h"
  30          void TIM1init(void);
  31          /*====================================
  32           ×Ô¶¨ÒåÀàÐÍÃû
  33          ====================================*/
  34          typedef unsigned char INT8U;
  35          typedef unsigned char uchar;
  36          typedef unsigned int INT16U;
  37          typedef unsigned int uint;
  38          unsigned char DisTempData[7];
  39          float S, arr[5];
  40          int i, k=0, j;
  41          /*====================================
  42          º¯Êý£ºvoid Delay_Ms(INT16U ms)
  43          ²ÎÊý£ºms£¬ºÁÃëÑÓÊ±ÐÎ²Î
  44          ÃèÊö£º12T 51µ¥Æ¬»ú×ÔÊÊÓ¦Ö÷Ê±ÖÓºÁÃë¼¶ÑÓÊ±º¯Êý
  45          ====================================*/
  46          void Delay_Ms(unsigned int ms)
  47          {
  48   1           unsigned int i;
  49   1         do{
  50   2              i = MAIN_Fosc / 96000; 
  51   2            while(--i);   //96T per loop
  52   2           }while(--ms);
  53   1      }
  54          /*====================================
C51 COMPILER V9.54   MAIN                                                                  05/12/2021 11:38:35 PAGE 2   

  55           Ó²¼þ½Ó¿ÚÎ»ÉùÃ÷
  56          ====================================*/
  57          sbit IR  = P3^2;     //¶¨ÒåºìÍâÂö³åÊý¾Ý½Ó¿Ú Íâ²¿ÖÐ¶ÏOÊäÈë¿Ú
  58          sbit TRIGL = P2 ^ 0;
  59          sbit ECHOL = P2 ^ 1;
  60          sbit TRIGB = P3 ^ 4;
  61          sbit ECHOB = P3 ^ 5;
  62          sbit TRIGR = P3 ^ 6;
  63          sbit ECHOR = P3 ^ 7;
  64          sbit SPK = P2 ^ 2;
  65          uchar IRtime;     //¼ì²âºìÍâ¸ßµçÆ½³ÖÐøÊ±¼ä£¨Âö¿í£©
  66          uchar IRcord[4];    //´ËÊý×éÓÃÓÚ´¢´æ·ÖÀë³öÀ´µÄ4¸ö×Ö½ÚµÄÊý¾Ý£¨ÓÃ»§Âë2¸ö×Ö½Ú+¼üÖµÂë2¸ö×Ö½Ú£©
  67          uchar IRdata[33];   //´ËÊý×éÓÃÓÚ´¢´æºìÍâµÄ33Î»Êý¾Ý£¨µÚÒ»Î»ÎªÒýµ¼ÂëÓÃ»§Âë16+¼üÖµÂë16£©
  68          bit IRpro_ok, IRok;  //µÚÒ»¸öÓÃÓÚºìÍâ½ÓÊÕ4¸ö×Ö½ÚÍê±Ï¡£IRokÓÃÎª¼ì²âÂö¿íÍê±Ï
  69          
  70          void init()    //³õÊ¼»¯¶¨Ê±Æ÷0 ºÍÍâ²¿ÖÐ¶Ï0
  71          {
  72   1        TMOD |= 0x02; //¶¨Ê±Æ÷0¹¤×÷·½Ê½2£¬8Î»×Ô¶¯ÖØ×°
  73   1        TH0 = 0x00;  //¸ß8Î»×°Èë0ÄÇÃ´¶¨Ê±Æ÷Òç³öÒ»´ÎµÄÊ±¼äÊÇ256¸ö»úÆ÷ÖÜÆÚ
  74   1        TL0 = 0x00;
  75   1        EA = 1;      //×ÜÖÐ¶Ï
  76   1        ET0 = 1;     //¶¨Ê±Æ÷0ÖÐ¶Ï
  77   1        TR0 = 1;     //Æô¶¯¶¨Ê±Æ÷0
  78   1        IT0 = 1;     //ÉèÖÃÍâ²¿ÖÐ¶Ï0ÎªÌøÑØ´¥·¢·½Ê½£¬À´Ò»¸öÏÂ½µÑØ´¥·¢Ò»´Î
  79   1        EX0 = 1;     //Æô¶¯Íâ²¿ÖÐ¶Ï0
  80   1      }
  81          
  82          void time0() interrupt 1   //¶¨Òå¶¨Ê±Æ÷0
  83          {
  84   1        IRtime++;          //¼ì²âÂö¿í£¬1´ÎÎª278us
  85   1      }
  86          
  87          void int0() interrupt 0       //¶¨ÒåÍâ²¿ÖÐ¶Ï0
  88          {
  89   1        static uchar i;       //  ÉùÃ÷¾²Ì¬±äÁ¿£¨ÔÚÌø³öº¯ÊýºóÔÚ»ØÀ´Ö´ÐÐµÄÊ±ºò²»»á¶ªÊ§ÊýÖµ£©iÓÃÓÚ°Ñ33´Î¸ßµçÆ½µÄ³ÖÐøÊ±¼
             -ä´æÈëIRdata
  90   1        static bit startflag;   //¿ªÊ¼´¢´æÂö¿í±êÖ¾Î»
  91   1        if(startflag)       //¿ªÊ¼½ÓÊÕÂö¿í¼ì²â
  92   1        {
  93   2          if( (IRtime < 53) && (IRtime >= 32) ) /*ÅÐ¶ÏÊÇ·ñÊÇÒýµ¼Âë£¬µ×µçÆ½9000us+¸ß4500us 
  94   2          Õâ¸ö×Ô¼º¿ÉÒÔËãÎÒÒÔ11.0592À´ËãÁËNECÐ­ÒéµÄÒýµ¼ÂëµÍ8000-10000+¸ß4000-5000 
  95   2          Èç¹ûÒÑ¾­½ÓÊÕÁËÒýµ¼ÂëÄÇÃ´i²»»á±»ÖÃ0¾Í»á¿ªÊ¼ÒÀ´Î´æÈëÂö¿í*/
  96   2            i = 0;         //Èç¹ûÊÇÒýµ¼ÂëÄÇÃ´Ö´ÐÐi=0°ÑËû´æµ½IRdataµÄµÚÒ»¸öÎ»
  97   2          IRdata[i] = IRtime;      //ÒÔT0µÄÒç³ö´ÎÊýÀ´¼ÆËãÂö¿í£¬°ÑÕâ¸öÊ±¼ä´æµ½Êý×éÀïÃæµ½ºóÃæÅÐ¶Ï
  98   2          IRtime = 0;        //¼ÆÊýÇåÁã£¬ÏÂÒ»¸öÏÂ½µÑØµÄÊ±ºòÔÚ´æÈëÂö¿í
  99   2          i++;           //¼ÆÊýÂö¿í´æÈëµÄ´ÎÊý
 100   2          if(i == 33)          //Èç¹û´æÈë34´Î Êý×éµÄÏÂ±êÊÇ´Ó0¿ªÊ¼iµÈÓÚ33±íÊ¾Ö´ÐÐÁË34´Î
 101   2          {
 102   3            IRok = 1;        //ÄÇÃ´±íÊ¾Âö¿í¼ì²âÍê±Ï
 103   3            i = 0;         //°ÑÂö¿í¼ÆÊýÇåÁã×¼±¸ÏÂ´Î´æÈë
 104   3          }
 105   2        }
 106   1        else      
 107   1        {
 108   2          IRtime = 0;          //Òýµ¼Âë¿ªÊ¼½øÈë°ÑÂö¿í¼ÆÊýÇåÁã¿ªÊ¼¼ÆÊý
 109   2          startflag = 1;       //¿ªÊ¼´¦Àí±êÖ¾Î»ÖÃ1
 110   2        }
 111   1      }
 112          
 113          void IRcordpro()           //ÌáÈ¡ËüµÄ33´ÎÂö¿í½øÐÐÊý¾Ý½âÂë
 114          {
 115   1        uchar i, j, k, cord, value; /*iÓÃÓÚ´¦Àí4¸ö×Ö½Ú£¬jÓÃÓÚ´¦ÀíÒ»¸ö×Ö½ÚÖÐÃ¿Ò»Î»£¬kÓÃÓÚ33´ÎÂö¿íÖÐµÄÄÄÒ»Î»
C51 COMPILER V9.54   MAIN                                                                  05/12/2021 11:38:35 PAGE 3   

 116   1        cordÓÃÓÚÈ¡³öÂö¿íµÄÊ±¼äÅÐ¶ÏÊÇ·ñ·ûºÏ1µÄÂö¿íÊ±¼ä*/
 117   1        k = 1;            //´ÓµÚÒ»Î»Âö¿í¿ªÊ¼È¡£¬¶ªÆúÒýµ¼ÂëÂö¿í
 118   1        for(i = 0; i < 4; i++)
 119   1        {
 120   2          for(j = 0; j < 8; j++)
 121   2          {
 122   3            cord = IRdata[k];     //°ÑÂö¿í´æÈëcord
 123   3            if(cord > 5)      //Èç¹ûÂö¿í´óÓÚÎÒ11.0592µÄt0Òç³öÂÊÎªÔ¼278us*5=1390ÄÇÃ´ÅÐ¶ÏÎª1
 124   3            value = value | 0x80; /*½ÓÊÕµÄÊ±ºòÊÇÏÈ½ÓÊÕ×îµÍÎ»£¬
 125   3            °Ñ×îµÍÎ»ÏÈ·Åµ½valueµÄ×î¸ßÎ»ÔÚºÍ0x08°´Î»»òÒ»ÏÂ
 126   3            ÕâÑù²»»á¸Ä±ävaluaµÄÆäËûÎ»µÄÊýÖµÖ»»áÈÃËû×î¸ßÎ»Îª1*/
 127   3            if(j < 7)
 128   3            {
 129   4              value = value >> 1; //valueÎ»×óÒÆÒÀ´Î½ÓÊÕ8Î»Êý¾Ý¡£
 130   4            }
 131   3            k++;        //Ã¿Ö´ÐÐÒ»´ÎÂö¿íÎ»¼Ó1
 132   3          }
 133   2          IRcord[i] = value;     //Ã¿´¦ÀíÍêÒ»¸ö×Ö½Ú°ÑËü·ÅÈëIRcordÊý×éÖÐ¡£
 134   2          value = 0;         //ÇåÁãvalue·½±ãÏÂ´ÎÔÚ´æÈëÊý¾Ý
 135   2        }
 136   1        IRpro_ok = 1;          //½ÓÊÕÍê4¸ö×Ö½ÚºóIRpro okÖÃ1±íÊ¾ºìÍâ½âÂëÍê³É 
 137   1      }
 138          /*PWM¿ØÖÆÊ¹ÄÜ Ð¡³µÇ°½ø*/
 139          void forward()
 140          {
 141   1        left_motor_go; //×óµç»úÇ°½ø
 142   1        right_motor_go; //ÓÒµç»úÇ°½ø
 143   1      }
 144          
 145            
 146          /*PWM¿ØÖÆÊ¹ÄÜ Ð¡³µºóÍË*/
 147          void backward()
 148          {
 149   1        left_motor_back; //×óµç»úºóÍË
 150   1        right_motor_back; //ÓÒµç»úºóÍË  
 151   1      }
 152          
 153          
 154          /*PWM¿ØÖÆÊ¹ÄÜ Ð¡³µ×ó×ª*/
 155          void left_run()
 156          {
 157   1        left_motor_stops; //×óµç»úÍ£Ö¹
 158   1        right_motor_go; //ÓÒµç»úÇ°½ø  
 159   1      }
 160          
 161          
 162          /*PWM¿ØÖÆÊ¹ÄÜ Ð¡³µÓÒ×ª*/
 163          void right_run()
 164          {
 165   1        right_motor_stops;//ÓÒµç»úÍ£Ö¹
 166   1        left_motor_go;    //×óµç»úÇ°½ø
 167   1      }
 168          
 169          
 170          /*Ð¡³µÍ£Ö¹*/
 171          void stop()
 172          {
 173   1        right_motor_stops;//ÓÒµç»úÍ£Ö¹
 174   1        left_motor_stops; //×óµç»úÍ£Ö¹  
 175   1      }
 176          
 177          void main()
C51 COMPILER V9.54   MAIN                                                                  05/12/2021 11:38:35 PAGE 4   

 178          {
 179   1        init(); //Ö´ÐÐ³õÊ¼»¯¶¨Ê±Æ÷0ºÍÍâ²¿ÖÐ¶Ï0
 180   1        TIM1init();    //??????0
 181   1        LCD_Init();    //???LCD
 182   1        Left_moto_pwm = Right_moto_pwm = 1;//Ê¹ÄÜ×óÓÒµç»ú
 183   1        while(1)  //´óÑ­»·
 184   1        {
 185   2          if(IRok)    //ÅÐ¶ÏÂö¿íÊÇ·ñ¼ì²âÍê±Ï                    
 186   2          {   
 187   3            IRcordpro();//¸ù¾ÝÂö¿í½âÂë³ö4¸ö×Ö½ÚµÄÊý¾Ý
 188   3            IRok = 0; //ÖØÐÂµÈ´ýÂö¿í¼ì²â
 189   3            if(IRpro_ok) //ÅÐ¶ÏÊÇ·ñ½âÂëÍê±Ï  
 190   3            {
 191   4                  switch(IRcord[2])
 192   4                {
 193   5                   case 0x18:  stop(); Delay_Ms(200); forward();       //Ç°½ø
 194   5                           break;
 195   5                   case 0x52:  stop(); Delay_Ms(200); backward();        //ºóÍË  
 196   5                           break;
 197   5                   case 0x08:  stop(); Delay_Ms(200); left_run();        //×ó×ª
 198   5                           break;
 199   5                 case 0x5A:  stop(); Delay_Ms(200); right_run();       //ÓÒ×ª
 200   5                           break;
 201   5                 case 0x1C:  stop();           //Í£Ö¹
 202   5                           break;
 203   5                 default:break;
 204   5                }
 205   4              IRpro_ok = 0;
 206   4            }
 207   3          }
 208   2        
 209   2          
 210   2          /*------------------------------------------------
 211   2                  ÓÒ·½
 212   2          ------------------------------------------------*/
 213   2          if (1)
 214   2          {
 215   3            /*one*/
 216   3            TRIGR = 1;
 217   3            DelayUs2x(10);
 218   3            TRIGR = 0;
 219   3            while (!ECHOR);
 220   3            TR1 = 1;
 221   3            while (ECHOR);
 222   3            TR1 = 0;
 223   3            S = TH1 * 256 + TL1;
 224   3            S = S / 58;
 225   3            arr[0] = S;
 226   3            TH1 = 0;
 227   3            TL1 = 0;
 228   3            /*two*/
 229   3            TRIGR = 1;
 230   3            DelayUs2x(10);
 231   3            TRIGR = 0;
 232   3            while (!ECHOR);
 233   3            TR1 = 1;
 234   3            while (ECHOR);
 235   3            TR1 = 0;
 236   3            S = TH1 * 256 + TL1;
 237   3            S = S / 58;
 238   3            arr[1] = S;
 239   3            TH1 = 0;
C51 COMPILER V9.54   MAIN                                                                  05/12/2021 11:38:35 PAGE 5   

 240   3            TL1 = 0;
 241   3            /*third*/
 242   3            TRIGR = 1;
 243   3            DelayUs2x(10);
 244   3            TRIGR = 0;
 245   3            while (!ECHOR);
 246   3            TR1 = 1;
 247   3            while (ECHOR);
 248   3            TR1 = 0;
 249   3            S = TH1 * 256 + TL1;
 250   3            S = S / 58;
 251   3            arr[2] = S;
 252   3            TH1 = 0;
 253   3            TL1 = 0;
 254   3            /*four*/
 255   3            TRIGR = 1;
 256   3            DelayUs2x(10);
 257   3            TRIGR = 0;
 258   3            while (!ECHOR);
 259   3            TR1 = 1;
 260   3            while (ECHOR);
 261   3            TR1 = 0;
 262   3            S = TH1 * 256 + TL1;
 263   3            S = S / 58;
 264   3            arr[3] = S;
 265   3            TH1 = 0;
 266   3            TL1 = 0;
 267   3            /*five*/
 268   3            TRIGR = 1;
 269   3            DelayUs2x(10);
 270   3            TRIGR = 0;
 271   3            while (!ECHOR);
 272   3            TR1 = 1;
 273   3            while (ECHOR);
 274   3            TR1 = 0;
 275   3            S = TH1 * 256 + TL1;
 276   3            S = S / 58;
 277   3            arr[4] = S;
 278   3            TH1 = 0;
 279   3            TL1 = 0;
 280   3            /*try*/
 281   3      
 282   3            for (i = 0; i < 5 - 1; i++)
 283   3              for (j = 0; j < 5 - 1 - i; j++)
 284   3                if (arr[j] > arr[j + 1])
 285   3                {
 286   4                  S = arr[j];
 287   4                  arr[j] = arr[j + 1];
 288   4                  arr[j + 1] = S;
 289   4                }
 290   3            /*try*/
 291   3            S = (arr[1] + arr[2] + arr[3] / 3);
 292   3            if (S < 10)
 293   3            {
 294   4      
 295   4            SPK = 0;//·ÀÖ¹Ò»Ö±¸øÀ®°ÈÍ¨µçÔì³ÉËð»µ
 296   4            DelayMs(250);
 297   4      
 298   4            }
 299   3            SPK = 1;
 300   3            sprintf(DisTempData, "R=%6.2f",S);
 301   3            LCD_Write_String(0, 1, DisTempData);
C51 COMPILER V9.54   MAIN                                                                  05/12/2021 11:38:35 PAGE 6   

 302   3          }
 303   2          /*------------------------------------------------
 304   2                ×ó·½
 305   2          ------------------------------------------------*/
 306   2          if (1)
 307   2          {
 308   3            /*one*/
 309   3            TRIGL = 1;
 310   3            DelayUs2x(10);
 311   3            TRIGL = 0;
 312   3            while (!ECHOL);
 313   3            TR1 = 1;
 314   3            while (ECHOL);
 315   3            TR1 = 0;
 316   3            S = TH1 * 256 + TL1;
 317   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 318   3            arr[0] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 319   3            TH1 = 0;
 320   3            TL1 = 0;
 321   3            /*two*/
 322   3            TRIGL = 1;
 323   3            DelayUs2x(10);
 324   3            TRIGL = 0;
 325   3            while (!ECHOL);
 326   3            TR1 = 1;
 327   3            while (ECHOL);
 328   3            TR1 = 0;
 329   3            S = TH1 * 256 + TL1;
 330   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 331   3            arr[1] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 332   3            TH1 = 0;
 333   3            TL1 = 0;
 334   3            /*third*/
 335   3            TRIGL = 1;
 336   3            DelayUs2x(10);
 337   3            TRIGL = 0;
 338   3            while (!ECHOL);
 339   3            TR1 = 1;
 340   3            while (ECHOL);
 341   3            TR1 = 0;
 342   3            S = TH1 * 256 + TL1;
 343   3            S = S / 58;
 344   3            arr[2] = S;
 345   3            TH1 = 0;
 346   3            TL1 = 0;
 347   3            /*four*/
 348   3            TRIGL = 1;
 349   3            DelayUs2x(10);
 350   3            TRIGL = 0;
 351   3            while (!ECHOL);
 352   3            TR1 = 1;
 353   3            while (ECHOL);
 354   3            TR1 = 0;
 355   3            S = TH1 * 256 + TL1;
 356   3            S = S / 58;
 357   3            arr[3] = S;
 358   3            TH1 = 0;
 359   3            TL1 = 0;
 360   3            /*five*/
 361   3            TRIGL = 1;
 362   3            DelayUs2x(10);
 363   3            TRIGL = 0;
C51 COMPILER V9.54   MAIN                                                                  05/12/2021 11:38:35 PAGE 7   

 364   3            while (!ECHOL);
 365   3            TR1 = 1;
 366   3            while (ECHOL);
 367   3            TR1 = 0;
 368   3            S = TH1 * 256 + TL1;
 369   3            S = S / 58;
 370   3            arr[4] = S;
 371   3            TH1 = 0;
 372   3            TL1 = 0;
 373   3            /*try*/
 374   3            for (i = 0; i < 10 - 1; i++)
 375   3              for (j = 0; j < 10 - 1 - i; j++)
 376   3                if (arr[j] > arr[j + 1])
 377   3                {
 378   4                  S = arr[j];
 379   4                  arr[j] = arr[j + 1];
 380   4                  arr[j + 1] = S;
 381   4                }
 382   3            /*try*/
 383   3            S = ((arr[1] + arr[2] + arr[3]  ) / 3);
 384   3            if (S < 10)
 385   3            {
 386   4              
 387   4            SPK = 0;//·ÀÖ¹Ò»Ö±¸øÀ®°ÈÍ¨µçÔì³ÉËð»µ
 388   4            DelayMs(250);
 389   4              
 390   4            }
 391   3            SPK = 1;
 392   3            sprintf(DisTempData,"L=%6.2f", S);
 393   3            LCD_Write_String(8, 1, DisTempData);
 394   3          }
 395   2          /*------------------------------------------------
 396   2                  ºó·½
 397   2          ------------------------------------------------*/
 398   2          if (1)
 399   2          {
 400   3            TRIGB = 1;
 401   3            DelayUs2x(10);
 402   3            TRIGB = 0;
 403   3            while (!ECHOB);
 404   3            TR1 = 1;
 405   3            while (ECHOB);
 406   3            TR1 = 0;
 407   3            S = TH1 * 256 + TL1;
 408   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 409   3            arr[0] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 410   3            TH1 = 0;
 411   3            TL1 = 0;
 412   3            /*two*/
 413   3            TRIGB = 1;
 414   3            DelayUs2x(10);
 415   3            TRIGB = 0;
 416   3            while (!ECHOB);
 417   3            TR1 = 1;
 418   3            while (ECHOB);
 419   3            TR1 = 0;
 420   3            S = TH1 * 256 + TL1;
 421   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 422   3            arr[1] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 423   3            TH1 = 0;
 424   3            TL1 = 0;
 425   3            /*third*/
C51 COMPILER V9.54   MAIN                                                                  05/12/2021 11:38:35 PAGE 8   

 426   3            TRIGB = 1;
 427   3            DelayUs2x(10);
 428   3            TRIGB = 0;
 429   3            while (!ECHOB);
 430   3            TR1 = 1;
 431   3            while (ECHOB);
 432   3            TR1 = 0;
 433   3            S = TH1 * 256 + TL1;
 434   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 435   3            arr[2] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 436   3            TH1 = 0;
 437   3            TL1 = 0;
 438   3            /*four*/
 439   3            TRIGB = 1;
 440   3            DelayUs2x(10);
 441   3            TRIGB = 0;
 442   3            while (!ECHOB);
 443   3            TR1 = 1;
 444   3            while (ECHOB);
 445   3            TR1 = 0;
 446   3            S = TH1 * 256 + TL1;
 447   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 448   3            arr[3] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 449   3            TH1 = 0;
 450   3            TL1 = 0;
 451   3            /*five*/
 452   3            TRIGB = 1;
 453   3            DelayUs2x(10);
 454   3            TRIGB = 0;
 455   3            while (!ECHOB);
 456   3            TR1 = 1;
 457   3            while (ECHOB);
 458   3            TR1 = 0;
 459   3            S = TH1 * 256 + TL1;
 460   3            S = S / 58;       //     58    ,  Y =(X *344)/2
 461   3            arr[4] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 462   3            TH1 = 0;
 463   3            TL1 = 0;
 464   3            /*try*/
 465   3            for (i = 0; i < 10 - 1; i++)
 466   3              for (j = 0; j < 10 - 1 - i; j++)
 467   3                if (arr[j] > arr[j + 1])
 468   3                {
 469   4                  S = arr[j];
 470   4                  arr[j] = arr[j + 1];
 471   4                  arr[j + 1] = S;
 472   4                }
 473   3            /*try*/
 474   3            S = (arr[1] + arr[2] + arr[3]   /3);
 475   3            if (S < 10)
 476   3            {
 477   4              
 478   4            SPK = 0;//·ÀÖ¹Ò»Ö±¸øÀ®°ÈÍ¨µçÔì³ÉËð»µ
 479   4            DelayMs(250);
 480   4              
 481   4            }
 482   3            SPK = 1;
 483   3            sprintf(DisTempData, "B=%6.2f", S);
 484   3            LCD_Write_String(4, 0, DisTempData);
 485   3      
 486   3          }
 487   2        }
C51 COMPILER V9.54   MAIN                                                                  05/12/2021 11:38:35 PAGE 9   

 488   1            }
 489            
 490          
 491            
 492          
 493          void TIM1init(void)
 494          {
 495   1      
 496   1        TMOD |= 0x10;
 497   1        TH1 = 0x00;
 498   1        TL1 = 0x00;
 499   1        ET1 = 1;
 500   1        EA = 1;
 501   1      }
 502          void Timer0_isr(void) interrupt 2
 503          {
 504   1        ECHOL = 0;
 505   1        ECHOB = 0;
 506   1        ECHOR = 0;
 507   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   2320    ----
   CONSTANT SIZE    =     24    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     76    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      3    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
