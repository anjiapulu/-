C51 COMPILER V9.54   MAIN                                                                  05/12/2021 09:43:39 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: C:\Program Files (x86)\Keil_v5\C51\BIN\C51.EXE main.c COMPACT OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECT
                    -EXTEND TABS(2)

line level    source

   1          /*********************************************************************************
   2          * ¡¾±àĞ´Ê±¼ä¡¿£º 2020Äê12ÔÂ12ÈÕ
   3          * ¡¾×÷    Õß¡¿£º ÇåÏèµç×Ó:03
   4          * ¡¾°æ    ±¾¡¿£º 1.0
   5          * ¡¾Íø    Õ¾¡¿£º http://www.QXMBOT.com/ 
   6          * ¡¾ÌÔ±¦µêÆÌ¡¿£º http://qxmcu.taobao.com/ (Ö±Ïúµê)
   7          * ¡¾ÊµÑéÆ½Ì¨¡¿£º QX-A11ÑÇ¿ËÁ¦ÖÇÄÜĞ¡³µ  STC89C52
   8          * ¡¾Íâ²¿¾§Õñ¡¿£º 11.0592mhz 
   9          * ¡¾Ö÷¿ØĞ¾Æ¬¡¿£º STC89C52
  10          * ¡¾±àÒë»·¾³¡¿£º Keil ¦ÌVisio4
  11          * °æÈ¨ËùÓĞ£¬µÁ°æ±Ø¾¿¡£
  12          * Copyright(C) QXMBOT
  13          * All rights reserved
  14          ***********************************************************************************
  15          * ¡¾½ÓÏßËµÃ÷¡¿£ºÇë²Î¿¼×ÊÁÏÄÚÍ¼ÎÄËµÃ÷Êé
  16          ³ÌĞòÃâ·Ñ¿ªÔ´£¬²»Ìá¹©´úÂë·ÖÎö
  17          ×¢ÒâÊÂÏîĞèÒªÓÃ»§²ÎÔÄ¡°*Ì×²Í×é×°µ÷ÊÔÖ¸ÄÏ¡± 
  18          ³ÌĞòÖ»×ö²Î¿¼£¬¸ù¾İÊµ¼ÊÔËĞĞĞ§¹û¿ÉÄÜ»¹ĞèÒªÓÃ»§×ÔĞĞµ÷ÊÔ                                
  19          **********************************************************************************/
  20          
  21          /*¿ª·¢°åP32¶Ë¿Ú²»ÄÜ½Ó¶Å°îÏß£¬·ñÔòÎŞ·¨Ò£¿Ø*/
  22          
  23          #include <reg52.h> //51Í·ÎÄ¼ş
  24          #include <QX_A11.h>//QX-A51ÖÇÄÜĞ¡³µÅäÖÃÎÄ¼ş
  25          #include <stdio.h>
  26          #include <math.h>
  27          #include "1602.h"
  28          #include "delay.h"
  29          #include "distance.h"
  30          #include "MatrixKey.h"
  31          /*====================================
  32           ×Ô¶¨ÒåÀàĞÍÃû
  33          ====================================*/
  34          typedef unsigned char INT8U;
  35          typedef unsigned char uchar;
  36          typedef unsigned int INT16U;
  37          typedef unsigned int uint;
  38          unsigned char DisTempData[7],nice[1];
  39          float S, arr[5];
  40          int leftnumber=0, backnumber=0, rightnumber=0;
  41          int i, k=0, j=10;
  42          /*====================================
  43          º¯Êı£ºvoid Delay_Ms(INT16U ms)
  44          ²ÎÊı£ºms£¬ºÁÃëÑÓÊ±ĞÎ²Î
  45          ÃèÊö£º12T 51µ¥Æ¬»ú×ÔÊÊÓ¦Ö÷Ê±ÖÓºÁÃë¼¶ÑÓÊ±º¯Êı
  46          ====================================*/
  47          void Delay_Ms(unsigned int ms)
  48          {
  49   1           unsigned int i;
  50   1         do{
  51   2              i = MAIN_Fosc / 96000; 
  52   2            while(--i);   //96T per loop
  53   2           }while(--ms);
  54   1      }
C51 COMPILER V9.54   MAIN                                                                  05/12/2021 09:43:39 PAGE 2   

  55          /*====================================
  56           Ó²¼ş½Ó¿ÚÎ»ÉùÃ÷
  57          ====================================*/
  58          sbit IR  = P3^2;     //¶¨ÒåºìÍâÂö³åÊı¾İ½Ó¿Ú Íâ²¿ÖĞ¶ÏOÊäÈë¿Ú
  59          sbit TRIGL = P2 ^ 0;
  60          sbit ECHOL = P2 ^ 1;
  61          sbit TRIGB = P3 ^ 4;
  62          sbit ECHOB = P3 ^ 5;
  63          sbit TRIGR = P3 ^ 6;
  64          sbit ECHOR = P3 ^ 7;
  65          sbit SPK = P2 ^ 2;
  66          uchar IRtime;     //¼ì²âºìÍâ¸ßµçÆ½³ÖĞøÊ±¼ä£¨Âö¿í£©
  67          uchar IRcord[4];    //´ËÊı×éÓÃÓÚ´¢´æ·ÖÀë³öÀ´µÄ4¸ö×Ö½ÚµÄÊı¾İ£¨ÓÃ»§Âë2¸ö×Ö½Ú+¼üÖµÂë2¸ö×Ö½Ú£©
  68          uchar IRdata[33];   //´ËÊı×éÓÃÓÚ´¢´æºìÍâµÄ33Î»Êı¾İ£¨µÚÒ»Î»ÎªÒıµ¼ÂëÓÃ»§Âë16+¼üÖµÂë16£©
  69          bit IRpro_ok, IRok;  //µÚÒ»¸öÓÃÓÚºìÍâ½ÓÊÕ4¸ö×Ö½ÚÍê±Ï¡£IRokÓÃÎª¼ì²âÂö¿íÍê±Ï
  70          
  71          void init()    //³õÊ¼»¯¶¨Ê±Æ÷0 ºÍÍâ²¿ÖĞ¶Ï0
  72          {
  73   1        TMOD |= 0x02; //¶¨Ê±Æ÷0¹¤×÷·½Ê½2£¬8Î»×Ô¶¯ÖØ×°
  74   1        TH0 = 0x00;  //¸ß8Î»×°Èë0ÄÇÃ´¶¨Ê±Æ÷Òç³öÒ»´ÎµÄÊ±¼äÊÇ256¸ö»úÆ÷ÖÜÆÚ
  75   1        TL0 = 0x00;
  76   1        EA = 1;      //×ÜÖĞ¶Ï
  77   1        ET0 = 1;     //¶¨Ê±Æ÷0ÖĞ¶Ï
  78   1        TR0 = 1;     //Æô¶¯¶¨Ê±Æ÷0
  79   1        IT0 = 1;     //ÉèÖÃÍâ²¿ÖĞ¶Ï0ÎªÌøÑØ´¥·¢·½Ê½£¬À´Ò»¸öÏÂ½µÑØ´¥·¢Ò»´Î
  80   1        EX0 = 1;     //Æô¶¯Íâ²¿ÖĞ¶Ï0
  81   1      }
  82          
  83          void time0() interrupt 1   //¶¨Òå¶¨Ê±Æ÷0
  84          {
  85   1        IRtime++;          //¼ì²âÂö¿í£¬1´ÎÎª278us
  86   1      }
  87          
  88          void int0() interrupt 0       //¶¨ÒåÍâ²¿ÖĞ¶Ï0
  89          {
  90   1        static uchar i;       //  ÉùÃ÷¾²Ì¬±äÁ¿£¨ÔÚÌø³öº¯ÊıºóÔÚ»ØÀ´Ö´ĞĞµÄÊ±ºò²»»á¶ªÊ§ÊıÖµ£©iÓÃÓÚ°Ñ33´Î¸ßµçÆ½µÄ³ÖĞøÊ±¼
             -ä´æÈëIRdata
  91   1        static bit startflag;   //¿ªÊ¼´¢´æÂö¿í±êÖ¾Î»
  92   1        if(startflag)       //¿ªÊ¼½ÓÊÕÂö¿í¼ì²â
  93   1        {
  94   2          if( (IRtime < 53) && (IRtime >= 32) ) /*ÅĞ¶ÏÊÇ·ñÊÇÒıµ¼Âë£¬µ×µçÆ½9000us+¸ß4500us 
  95   2          Õâ¸ö×Ô¼º¿ÉÒÔËãÎÒÒÔ11.0592À´ËãÁËNECĞ­ÒéµÄÒıµ¼ÂëµÍ8000-10000+¸ß4000-5000 
  96   2          Èç¹ûÒÑ¾­½ÓÊÕÁËÒıµ¼ÂëÄÇÃ´i²»»á±»ÖÃ0¾Í»á¿ªÊ¼ÒÀ´Î´æÈëÂö¿í*/
  97   2            i = 0;         //Èç¹ûÊÇÒıµ¼ÂëÄÇÃ´Ö´ĞĞi=0°ÑËû´æµ½IRdataµÄµÚÒ»¸öÎ»
  98   2          IRdata[i] = IRtime;      //ÒÔT0µÄÒç³ö´ÎÊıÀ´¼ÆËãÂö¿í£¬°ÑÕâ¸öÊ±¼ä´æµ½Êı×éÀïÃæµ½ºóÃæÅĞ¶Ï
  99   2          IRtime = 0;        //¼ÆÊıÇåÁã£¬ÏÂÒ»¸öÏÂ½µÑØµÄÊ±ºòÔÚ´æÈëÂö¿í
 100   2          i++;           //¼ÆÊıÂö¿í´æÈëµÄ´ÎÊı
 101   2          if(i == 33)          //Èç¹û´æÈë34´Î Êı×éµÄÏÂ±êÊÇ´Ó0¿ªÊ¼iµÈÓÚ33±íÊ¾Ö´ĞĞÁË34´Î
 102   2          {
 103   3            IRok = 1;        //ÄÇÃ´±íÊ¾Âö¿í¼ì²âÍê±Ï
 104   3            i = 0;         //°ÑÂö¿í¼ÆÊıÇåÁã×¼±¸ÏÂ´Î´æÈë
 105   3          }
 106   2        }
 107   1        else      
 108   1        {
 109   2          IRtime = 0;          //Òıµ¼Âë¿ªÊ¼½øÈë°ÑÂö¿í¼ÆÊıÇåÁã¿ªÊ¼¼ÆÊı
 110   2          startflag = 1;       //¿ªÊ¼´¦Àí±êÖ¾Î»ÖÃ1
 111   2        }
 112   1      }
 113          
 114          void IRcordpro()           //ÌáÈ¡ËüµÄ33´ÎÂö¿í½øĞĞÊı¾İ½âÂë
 115          {
C51 COMPILER V9.54   MAIN                                                                  05/12/2021 09:43:39 PAGE 3   

 116   1        uchar i, j, k, cord, value; /*iÓÃÓÚ´¦Àí4¸ö×Ö½Ú£¬jÓÃÓÚ´¦ÀíÒ»¸ö×Ö½ÚÖĞÃ¿Ò»Î»£¬kÓÃÓÚ33´ÎÂö¿íÖĞµÄÄÄÒ»Î»
 117   1        cordÓÃÓÚÈ¡³öÂö¿íµÄÊ±¼äÅĞ¶ÏÊÇ·ñ·ûºÏ1µÄÂö¿íÊ±¼ä*/
 118   1        k = 1;            //´ÓµÚÒ»Î»Âö¿í¿ªÊ¼È¡£¬¶ªÆúÒıµ¼ÂëÂö¿í
 119   1        for(i = 0; i < 4; i++)
 120   1        {
 121   2          for(j = 0; j < 8; j++)
 122   2          {
 123   3            cord = IRdata[k];     //°ÑÂö¿í´æÈëcord
 124   3            if(cord > 5)      //Èç¹ûÂö¿í´óÓÚÎÒ11.0592µÄt0Òç³öÂÊÎªÔ¼278us*5=1390ÄÇÃ´ÅĞ¶ÏÎª1
 125   3            value = value | 0x80; /*½ÓÊÕµÄÊ±ºòÊÇÏÈ½ÓÊÕ×îµÍÎ»£¬
 126   3            °Ñ×îµÍÎ»ÏÈ·Åµ½valueµÄ×î¸ßÎ»ÔÚºÍ0x08°´Î»»òÒ»ÏÂ
 127   3            ÕâÑù²»»á¸Ä±ävaluaµÄÆäËûÎ»µÄÊıÖµÖ»»áÈÃËû×î¸ßÎ»Îª1*/
 128   3            if(j < 7)
 129   3            {
 130   4              value = value >> 1; //valueÎ»×óÒÆÒÀ´Î½ÓÊÕ8Î»Êı¾İ¡£
 131   4            }
 132   3            k++;        //Ã¿Ö´ĞĞÒ»´ÎÂö¿íÎ»¼Ó1
 133   3          }
 134   2          IRcord[i] = value;     //Ã¿´¦ÀíÍêÒ»¸ö×Ö½Ú°ÑËü·ÅÈëIRcordÊı×éÖĞ¡£
 135   2          value = 0;         //ÇåÁãvalue·½±ãÏÂ´ÎÔÚ´æÈëÊı¾İ
 136   2        }
 137   1        IRpro_ok = 1;          //½ÓÊÕÍê4¸ö×Ö½ÚºóIRpro okÖÃ1±íÊ¾ºìÍâ½âÂëÍê³É 
 138   1      }
 139          /*PWM¿ØÖÆÊ¹ÄÜ Ğ¡³µÇ°½ø*/
 140          void forward()
 141          {
 142   1        left_motor_go; //×óµç»úÇ°½ø
 143   1        right_motor_go; //ÓÒµç»úÇ°½ø
 144   1      }
 145          
 146            
 147          /*PWM¿ØÖÆÊ¹ÄÜ Ğ¡³µºóÍË*/
 148          void backward()
 149          {
 150   1        left_motor_back; //×óµç»úºóÍË
 151   1        right_motor_back; //ÓÒµç»úºóÍË  
 152   1      }
 153          
 154          
 155          /*PWM¿ØÖÆÊ¹ÄÜ Ğ¡³µ×ó×ª*/
 156          void left_run()
 157          {
 158   1        left_motor_stops; //×óµç»úÍ£Ö¹
 159   1        right_motor_go; //ÓÒµç»úÇ°½ø  
 160   1      }
 161          
 162          
 163          /*PWM¿ØÖÆÊ¹ÄÜ Ğ¡³µÓÒ×ª*/
 164          void right_run()
 165          {
 166   1        right_motor_stops;//ÓÒµç»úÍ£Ö¹
 167   1        left_motor_go;    //×óµç»úÇ°½ø
 168   1      }
 169          
 170          
 171          /*Ğ¡³µÍ£Ö¹*/
 172          void stop()
 173          {
 174   1        right_motor_stops;//ÓÒµç»úÍ£Ö¹
 175   1        left_motor_stops; //×óµç»úÍ£Ö¹  
 176   1      }
 177          
C51 COMPILER V9.54   MAIN                                                                  05/12/2021 09:43:39 PAGE 4   

 178          void main()
 179          {
 180   1        init(); //Ö´ĞĞ³õÊ¼»¯¶¨Ê±Æ÷0ºÍÍâ²¿ÖĞ¶Ï0
 181   1        TIM1init();    //??????0
 182   1        LCD_Init();    //???LCD
 183   1        Left_moto_pwm = Right_moto_pwm = 1;//Ê¹ÄÜ×óÓÒµç»ú
 184   1        while(1)  //´óÑ­»·
 185   1        {
 186   2          if(IRok)    //ÅĞ¶ÏÂö¿íÊÇ·ñ¼ì²âÍê±Ï                    
 187   2          {   
 188   3            IRcordpro();//¸ù¾İÂö¿í½âÂë³ö4¸ö×Ö½ÚµÄÊı¾İ
 189   3            IRok = 0; //ÖØĞÂµÈ´ıÂö¿í¼ì²â
 190   3            if(IRpro_ok) //ÅĞ¶ÏÊÇ·ñ½âÂëÍê±Ï  
 191   3            {
 192   4                  switch(IRcord[2])
 193   4                {
 194   5                   case 0x18:  stop(); Delay_Ms(200); forward();       //Ç°½ø
 195   5                           break;
 196   5                   case 0x52:  stop(); Delay_Ms(200); backward();        //ºóÍË  
 197   5                           break;
 198   5                   case 0x08:  stop(); Delay_Ms(200); left_run();        //×ó×ª
 199   5                           break;
 200   5                 case 0x5A:  stop(); Delay_Ms(200); right_run();       //ÓÒ×ª
 201   5                           break;
 202   5                 case 0x1C:  stop();           //Í£Ö¹
 203   5                           break;
 204   5                 default:break;
 205   5                }
 206   4              IRpro_ok = 0;
 207   4            }
 208   3            if(1)
 209   3            {
 210   4        while (1)
 211   4        {
 212   5      
 213   5          /*·äÃùÆ÷¾¯½äÖµÊäÈë*/
 214   5          while (k <= 3)
 215   5          {
 216   6            if (k == 0)
 217   6            {
 218   7                LCD_Write_String(0, 1, " L___ B___ R___ ");
 219   7            }
 220   6            LCD_Write_String(0, 0, "   input dist   ");
 221   6            j = MatrixKey();
 222   6            if (j == 13)
 223   6            {
 224   7              k++;
 225   7              if (k == 1)
 226   7              {
 227   8                for (i = 2; i < 5;)
 228   8                {
 229   9                  j = MatrixKey();
 230   9                  if(i==2)
 231   9                  {
 232  10                  if(j>0&&j<10)
 233  10                  {
 234  11                  leftnumber+=(j*100);
 235  11                  }
 236  10                  }
 237   9                  if(i==3)
 238   9                  {
 239  10                  if(j>0&&j<10)
C51 COMPILER V9.54   MAIN                                                                  05/12/2021 09:43:39 PAGE 5   

 240  10                  {
 241  11                  leftnumber+=(j*10);
 242  11                  }
 243  10                  }
 244   9                  if(i==4)
 245   9                  {
 246  10                  if(j>0&&j<10)
 247  10                  {
 248  11                  leftnumber+=(j);
 249  11                  }
 250  10                  }
 251   9                  if (j < 10)
 252   9                  {
 253  10                    
 254  10                    sprintf(nice, "%d",j);
 255  10                    LCD_Write_Char(i, 1,nice[0] );
 256  10                    i++;
 257  10                  }
 258   9                  DelayMs(50);
 259   9              
 260   9                }
 261   8              }
 262   7              if (k == 2)
 263   7              {
 264   8                for (i = 7; i < 10; )
 265   8                {
 266   9                  j = MatrixKey();
 267   9                  if(i==7)
 268   9                  {
 269  10                  if(j>0&&j<10)
 270  10                  {
 271  11                  backnumber+=(j*100);
 272  11                  }
 273  10                  }
 274   9                  if(i==8)
 275   9                  {
 276  10                  if(j>0&&j<10)
 277  10                  {
 278  11                  backnumber+=(j*10);
 279  11                  }
 280  10                  }
 281   9                  if(i==9)
 282   9                  {
 283  10                  if(j>0&&j<10)
 284  10                  {
 285  11                  backnumber+=(j);
 286  11                  }
 287  10                  }
 288   9                  if (j < 10)
 289   9                  {
 290  10                    sprintf(nice, "%d",j);
 291  10                    LCD_Write_Char(i, 1,nice[0] );
 292  10                    i++;
 293  10                  }
 294   9                  DelayMs(50);
 295   9                }
 296   8              }
 297   7              if (k == 3)
 298   7              {
 299   8                k=4;
 300   8                for (i = 12; i < 15; )
 301   8                {
C51 COMPILER V9.54   MAIN                                                                  05/12/2021 09:43:39 PAGE 6   

 302   9                  j = MatrixKey();
 303   9                  if(i==12)
 304   9                  {
 305  10                  if(j>0&&j<10)
 306  10                  {
 307  11                  rightnumber+=(j*100);
 308  11                  }
 309  10                  }
 310   9                  if(i==13)
 311   9                  {
 312  10                  if(j>0&&j<10)
 313  10                  {
 314  11                  rightnumber+=(j*10);
 315  11                  }
 316  10                  }
 317   9                  if(i==14)
 318   9                  {
 319  10                  if(j>0&&j<10)
 320  10                  {
 321  11                  rightnumber+=(j);
 322  11                  }
 323  10                  }
 324   9                  if (j < 10)
 325   9                  {
 326  10                    sprintf(nice, "%d",j                                                       );
 327  10                    LCD_Write_Char(i, 1,nice[0] );
 328  10                    i++;
 329  10                  }
 330   9                  DelayMs(50);
 331   9                }
 332   8      
 333   8                LCD_Write_String(0, 0, "                ");
 334   8              }
 335   7            }
 336   6          }
 337   5        
 338   5          
 339   5          /*------------------------------------------------
 340   5                  ÓÒ·½
 341   5          ------------------------------------------------*/
 342   5          if (1)
 343   5          {
 344   6            /*one*/
 345   6            TRIGR = 1;
 346   6            DelayUs2x(10);
 347   6            TRIGR = 0;
 348   6            while (!ECHOR);
 349   6            TR1 = 1;
 350   6            while (ECHOR);
 351   6            TR1 = 0;
 352   6            S = TH1 * 256 + TL1;
 353   6            S = S / 58;
 354   6            arr[0] = S;
 355   6            TH1 = 0;
 356   6            TL1 = 0;
 357   6            /*two*/
 358   6            TRIGR = 1;
 359   6            DelayUs2x(10);
 360   6            TRIGR = 0;
 361   6            while (!ECHOR);
 362   6            TR1 = 1;
 363   6            while (ECHOR);
C51 COMPILER V9.54   MAIN                                                                  05/12/2021 09:43:39 PAGE 7   

 364   6            TR1 = 0;
 365   6            S = TH1 * 256 + TL1;
 366   6            S = S / 58;
 367   6            arr[1] = S;
 368   6            TH1 = 0;
 369   6            TL1 = 0;
 370   6            /*third*/
 371   6            TRIGR = 1;
 372   6            DelayUs2x(10);
 373   6            TRIGR = 0;
 374   6            while (!ECHOR);
 375   6            TR1 = 1;
 376   6            while (ECHOR);
 377   6            TR1 = 0;
 378   6            S = TH1 * 256 + TL1;
 379   6            S = S / 58;
 380   6            arr[2] = S;
 381   6            TH1 = 0;
 382   6            TL1 = 0;
 383   6            /*four*/
 384   6            TRIGR = 1;
 385   6            DelayUs2x(10);
 386   6            TRIGR = 0;
 387   6            while (!ECHOR);
 388   6            TR1 = 1;
 389   6            while (ECHOR);
 390   6            TR1 = 0;
 391   6            S = TH1 * 256 + TL1;
 392   6            S = S / 58;
 393   6            arr[3] = S;
 394   6            TH1 = 0;
 395   6            TL1 = 0;
 396   6            /*five*/
 397   6            TRIGR = 1;
 398   6            DelayUs2x(10);
 399   6            TRIGR = 0;
 400   6            while (!ECHOR);
 401   6            TR1 = 1;
 402   6            while (ECHOR);
 403   6            TR1 = 0;
 404   6            S = TH1 * 256 + TL1;
 405   6            S = S / 58;
 406   6            arr[4] = S;
 407   6            TH1 = 0;
 408   6            TL1 = 0;
 409   6            /*try*/
 410   6      
 411   6            for (i = 0; i < 5 - 1; i++)
 412   6              for (j = 0; j < 5 - 1 - i; j++)
 413   6                if (arr[j] > arr[j + 1])
 414   6                {
 415   7                  S = arr[j];
 416   7                  arr[j] = arr[j + 1];
 417   7                  arr[j + 1] = S;
 418   7                }
 419   6            /*try*/
 420   6            S = (arr[1] + arr[2] + arr[3] + arr[4] / 4);
 421   6            if (S < rightnumber)
 422   6            {
 423   7      
 424   7            SPK = 0;//·ÀÖ¹Ò»Ö±¸øÀ®°ÈÍ¨µçÔì³ÉËğ»µ
 425   7            DelayMs(250);
C51 COMPILER V9.54   MAIN                                                                  05/12/2021 09:43:39 PAGE 8   

 426   7      
 427   7            }
 428   6            SPK = 1;
 429   6            sprintf(DisTempData, "R=%6.2f",S);
 430   6            LCD_Write_String(0, 1, DisTempData);
 431   6          }
 432   5          /*------------------------------------------------
 433   5                ×ó·½
 434   5          ------------------------------------------------*/
 435   5          if (1)
 436   5          {
 437   6            /*one*/
 438   6            TRIGL = 1;
 439   6            DelayUs2x(10);
 440   6            TRIGL = 0;
 441   6            while (!ECHOL);
 442   6            TR1 = 1;
 443   6            while (ECHOL);
 444   6            TR1 = 0;
 445   6            S = TH1 * 256 + TL1;
 446   6            S = S / 58;       //     58    ,  Y =(X *344)/2
 447   6            arr[0] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 448   6            TH1 = 0;
 449   6            TL1 = 0;
 450   6            /*two*/
 451   6            TRIGL = 1;
 452   6            DelayUs2x(10);
 453   6            TRIGL = 0;
 454   6            while (!ECHOL);
 455   6            TR1 = 1;
 456   6            while (ECHOL);
 457   6            TR1 = 0;
 458   6            S = TH1 * 256 + TL1;
 459   6            S = S / 58;       //     58    ,  Y =(X *344)/2
 460   6            arr[1] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 461   6            TH1 = 0;
 462   6            TL1 = 0;
 463   6            /*third*/
 464   6            TRIGL = 1;
 465   6            DelayUs2x(10);
 466   6            TRIGL = 0;
 467   6            while (!ECHOL);
 468   6            TR1 = 1;
 469   6            while (ECHOL);
 470   6            TR1 = 0;
 471   6            S = TH1 * 256 + TL1;
 472   6            S = S / 58;
 473   6            arr[2] = S;
 474   6            TH1 = 0;
 475   6            TL1 = 0;
 476   6            /*four*/
 477   6            TRIGL = 1;
 478   6            DelayUs2x(10);
 479   6            TRIGL = 0;
 480   6            while (!ECHOL);
 481   6            TR1 = 1;
 482   6            while (ECHOL);
 483   6            TR1 = 0;
 484   6            S = TH1 * 256 + TL1;
 485   6            S = S / 58;
 486   6            arr[3] = S;
 487   6            TH1 = 0;
C51 COMPILER V9.54   MAIN                                                                  05/12/2021 09:43:39 PAGE 9   

 488   6            TL1 = 0;
 489   6            /*five*/
 490   6            TRIGL = 1;
 491   6            DelayUs2x(10);
 492   6            TRIGL = 0;
 493   6            while (!ECHOL);
 494   6            TR1 = 1;
 495   6            while (ECHOL);
 496   6            TR1 = 0;
 497   6            S = TH1 * 256 + TL1;
 498   6            S = S / 58;
 499   6            arr[4] = S;
 500   6            TH1 = 0;
 501   6            TL1 = 0;
 502   6            /*try*/
 503   6            for (i = 0; i < 10 - 1; i++)
 504   6              for (j = 0; j < 10 - 1 - i; j++)
 505   6                if (arr[j] > arr[j + 1])
 506   6                {
 507   7                  S = arr[j];
 508   7                  arr[j] = arr[j + 1];
 509   7                  arr[j + 1] = S;
 510   7                }
 511   6            /*try*/
 512   6            S = ((arr[1] + arr[2] + arr[3] + arr[4] ) / 4);
 513   6            if (S < leftnumber)
 514   6            {
 515   7              
 516   7            SPK = 0;//·ÀÖ¹Ò»Ö±¸øÀ®°ÈÍ¨µçÔì³ÉËğ»µ
 517   7            DelayMs(250);
 518   7              
 519   7            }
 520   6            SPK = 1;
 521   6            sprintf(DisTempData,"L=%6.2f", S);
 522   6            LCD_Write_String(8, 1, DisTempData);
 523   6          }
 524   5          /*------------------------------------------------
 525   5                  ºó·½
 526   5          ------------------------------------------------*/
 527   5          if (1)
 528   5          {
 529   6            TRIGB = 1;
 530   6            DelayUs2x(10);
 531   6            TRIGB = 0;
 532   6            while (!ECHOB);
 533   6            TR1 = 1;
 534   6            while (ECHOB);
 535   6            TR1 = 0;
 536   6            S = TH1 * 256 + TL1;
 537   6            S = S / 58;       //     58    ,  Y =(X *344)/2
 538   6            arr[0] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 539   6            TH1 = 0;
 540   6            TL1 = 0;
 541   6            /*two*/
 542   6            TRIGB = 1;
 543   6            DelayUs2x(10);
 544   6            TRIGB = 0;
 545   6            while (!ECHOB);
 546   6            TR1 = 1;
 547   6            while (ECHOB);
 548   6            TR1 = 0;
 549   6            S = TH1 * 256 + TL1;
C51 COMPILER V9.54   MAIN                                                                  05/12/2021 09:43:39 PAGE 10  

 550   6            S = S / 58;       //     58    ,  Y =(X *344)/2
 551   6            arr[1] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 552   6            TH1 = 0;
 553   6            TL1 = 0;
 554   6            /*third*/
 555   6            TRIGB = 1;
 556   6            DelayUs2x(10);
 557   6            TRIGB = 0;
 558   6            while (!ECHOB);
 559   6            TR1 = 1;
 560   6            while (ECHOB);
 561   6            TR1 = 0;
 562   6            S = TH1 * 256 + TL1;
 563   6            S = S / 58;       //     58    ,  Y =(X *344)/2
 564   6            arr[2] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 565   6            TH1 = 0;
 566   6            TL1 = 0;
 567   6            /*four*/
 568   6            TRIGB = 1;
 569   6            DelayUs2x(10);
 570   6            TRIGB = 0;
 571   6            while (!ECHOB);
 572   6            TR1 = 1;
 573   6            while (ECHOB);
 574   6            TR1 = 0;
 575   6            S = TH1 * 256 + TL1;
 576   6            S = S / 58;       //     58    ,  Y =(X *344)/2
 577   6            arr[3] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 578   6            TH1 = 0;
 579   6            TL1 = 0;
 580   6            /*five*/
 581   6            TRIGB = 1;
 582   6            DelayUs2x(10);
 583   6            TRIGB = 0;
 584   6            while (!ECHOB);
 585   6            TR1 = 1;
 586   6            while (ECHOB);
 587   6            TR1 = 0;
 588   6            S = TH1 * 256 + TL1;
 589   6            S = S / 58;       //     58    ,  Y =(X *344)/2
 590   6            arr[4] = S;      // X =( 2*Y )/344 -> X =0.0058*Y  ->   =  /58 
 591   6            TH1 = 0;
 592   6            TL1 = 0;
 593   6            /*try*/
 594   6            for (i = 0; i < 10 - 1; i++)
 595   6              for (j = 0; j < 10 - 1 - i; j++)
 596   6                if (arr[j] > arr[j + 1])
 597   6                {
 598   7                  S = arr[j];
 599   7                  arr[j] = arr[j + 1];
 600   7                  arr[j + 1] = S;
 601   7                }
 602   6            /*try*/
 603   6            S = (arr[1] + arr[2] + arr[3] + arr[4]  /4);
 604   6            if (S < backnumber)
 605   6            {
 606   7              
 607   7            SPK = 0;//·ÀÖ¹Ò»Ö±¸øÀ®°ÈÍ¨µçÔì³ÉËğ»µ
 608   7            DelayMs(250);
 609   7              
 610   7            }
 611   6            SPK = 1;
C51 COMPILER V9.54   MAIN                                                                  05/12/2021 09:43:39 PAGE 11  

 612   6            sprintf(DisTempData, "B=%6.2f", S);
 613   6            LCD_Write_String(4, 0, DisTempData);
 614   6      
 615   6          }
 616   5        }
 617   4            }
 618   3          } 
 619   2      
 620   2        }
 621   1      }
 622          void TIM1init(void)
 623          {
 624   1      
 625   1        TMOD |= 0x10;
 626   1        TH1 = 0x00;
 627   1        TL1 = 0x00;
 628   1        ET1 = 1;
 629   1        EA = 1;
 630   1      }
 631          void Timer0_isr(void) interrupt 2
 632          {
 633   1        ECHOL = 0;
 634   1        ECHOB = 0;
 635   1        ECHOR = 0;
 636   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   3883    ----
   CONSTANT SIZE    =     78    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =     83    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      3    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
