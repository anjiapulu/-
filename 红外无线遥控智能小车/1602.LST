C51 COMPILER V9.54   1602                                                                  05/12/2021 11:38:35 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE 1602
OBJECT MODULE PLACED IN 1602.OBJ
COMPILER INVOKED BY: C:\Program Files (x86)\Keil_v5\C51\BIN\C51.EXE 1602.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND T
                    -ABS(2)

line level    source

   1          /*-----------------------------------------------
   2            名称：LCD1602
   3            论坛：www.doflye.net
   4            编写：shifang
   5            日期：2009.5
   6            修改：无
   7            内容：
   8            引脚定义如下：1-VSS 2-VDD 3-V0 4-RS 5-R/W 6-E 7-14 DB0-DB7 15-BLA 16-BLK
   9          ------------------------------------------------*/
  10          #include "1602.h"
  11          #include "delay.h"
  12          
  13          #define CHECK_BUSY//是否使用判断忙语句条件，后面使用条件编译
  14          
  15          sbit RS = P2^4;   //定义端口 
  16          sbit RW = P2^5;
  17          sbit EN = P2^6;
  18          
  19          #define RS_CLR RS=0 
  20          #define RS_SET RS=1
  21          #define RW_CLR RW=0 
  22          #define RW_SET RW=1 
  23          #define EN_CLR EN=0
  24          #define EN_SET EN=1
  25          #define DataPort P0
  26          
  27          /*------------------------------------------------
  28                        判忙函数
  29          ------------------------------------------------*/
  30           bit LCD_Check_Busy(void) 
  31           { 
  32   1       #ifdef CHECK_BUSY
  33   1       DataPort= 0xFF; 
  34   1       RS_CLR; 
  35   1       RW_SET; 
  36   1       EN_CLR; 
  37   1       _nop_(); 
  38   1       EN_SET;
  39   1       return (bit)(DataPort & 0x80);
  40   1       #else
               return 0;
               #endif
  43   1       }
  44          /*------------------------------------------------
  45                        写入命令函数
  46          ------------------------------------------------*/
  47           void LCD_Write_Com(unsigned char com) 
  48           {  
  49   1       while(LCD_Check_Busy()); //忙则等待
  50   1       RS_CLR; 
  51   1       RW_CLR; 
  52   1       EN_SET; 
  53   1       DataPort= com; 
  54   1       _nop_(); 
C51 COMPILER V9.54   1602                                                                  05/12/2021 11:38:35 PAGE 2   

  55   1       EN_CLR;
  56   1       }
  57          /*------------------------------------------------
  58                        写入数据函数
  59          ------------------------------------------------*/
  60           void LCD_Write_Data(unsigned char Data) 
  61           { 
  62   1       while(LCD_Check_Busy()); //忙则等待
  63   1       RS_SET; 
  64   1       RW_CLR; 
  65   1       EN_SET; 
  66   1       DataPort= Data; 
  67   1       _nop_();
  68   1       EN_CLR;
  69   1       }
  70          
  71          /*------------------------------------------------
  72                          清屏函数
  73          ------------------------------------------------*/
  74           /*void LCD_Clear(void) 
  75           { 
  76           LCD_Write_Com(0x01); 
  77           DelayMs(5);
  78           }*/
  79          /*------------------------------------------------
  80                        写入字符串函数
  81          ------------------------------------------------*/
  82           void LCD_Write_String(unsigned char x,unsigned char y,unsigned char *s) 
  83           {     
  84   1             
  85   1       while (*s) 
  86   1        {     
  87   2       LCD_Write_Char(x,y,*s);     
  88   2       s ++;  x++;   
  89   2        }
  90   1       }
  91          /*------------------------------------------------
  92                        写入字符函数
  93          ------------------------------------------------*/
  94          void LCD_Write_Char(unsigned char x,unsigned char y,unsigned char Data) 
  95           {     
  96   1       if (y == 0) 
  97   1        {     
  98   2        LCD_Write_Com(0x80 + x);     
  99   2        }    
 100   1       else 
 101   1        {     
 102   2        LCD_Write_Com(0xC0 + x);     
 103   2        }        
 104   1       LCD_Write_Data( Data);  
 105   1       }
 106          /*------------------------------------------------
 107                        初始化函数
 108          ------------------------------------------------*/
 109           void LCD_Init(void) 
 110           {
 111   1         LCD_Write_Com(0x38);    /*显示模式设置*/ 
 112   1         DelayMs(5); 
 113   1         LCD_Write_Com(0x38); 
 114   1         DelayMs(5); 
 115   1         LCD_Write_Com(0x38); 
 116   1         DelayMs(5); 
C51 COMPILER V9.54   1602                                                                  05/12/2021 11:38:35 PAGE 3   

 117   1         LCD_Write_Com(0x38);  
 118   1         LCD_Write_Com(0x08);    /*显示关闭*/ 
 119   1         LCD_Write_Com(0x01);    /*显示清屏*/ 
 120   1         LCD_Write_Com(0x06);    /*显示光标移动设置*/ 
 121   1         DelayMs(5); 
 122   1         LCD_Write_Com(0x0C);    /*显示开及光标设置*/
 123   1      }
 124             
 125          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    178    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       5
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
